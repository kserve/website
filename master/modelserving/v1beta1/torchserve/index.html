
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="KServe Documentation">
      
      
      
        <link rel="canonical" href="https://kserve.io/website/master/modelserving/v1beta1/torchserve/">
      
      <link rel="icon" href="../../../images/favicon/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.0.5">
    
    
      
        <title>PyTorch - KServe Documentation Website</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a617204b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deploy-a-pytorch-model-with-torchserve-inferenceservice" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
 <h1>
   <b>KServe v0.15 is Released</b>, <a href="/website/0.15/blog/articles/2025-05-27-KServe-0.15-release/">Read blog &gt;&gt;</a>
 </h1>

          </div>
        </aside>
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="KServe Documentation Website" class="md-header__button md-logo" aria-label="KServe Documentation Website" data-md-component="logo">
      
  <img src="../../../images/logo/kserve.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KServe Documentation Website
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PyTorch
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kserve/kserve" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../get_started/" class="md-tabs__link">
        Getting started
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../admin/serverless/serverless/" class="md-tabs__link">
        Administration Guide
      </a>
    </li>
  

  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../control_plane/" class="md-tabs__link md-tabs__link--active">
        User Guide
      </a>
    </li>
  

  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../reference/api/" class="md-tabs__link">
        API Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../developer/developer/" class="md-tabs__link">
        Developer Guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../blog/articles/2025-05-27-KServe-0.15-release/" class="md-tabs__link">
        Blog
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../community/get_involved/" class="md-tabs__link">
        Community
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="KServe Documentation Website" class="md-nav__button md-logo" aria-label="KServe Documentation Website" data-md-component="logo">
      
  <img src="../../../images/logo/kserve.png" alt="logo">

    </a>
    KServe Documentation Website
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kserve/kserve" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../get_started/" class="md-nav__link">
        KServe Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../get_started/first_isvc/" class="md-nav__link">
        First InferenceService
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../get_started/swagger_ui/" class="md-nav__link">
        Interact with InferenceService Swagger UI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Administration Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administration Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Administration Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Install KServe
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Install KServe" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Install KServe
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_1" type="checkbox" id="__nav_3_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_1">
          Predictive Inference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Predictive Inference" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_1">
          <span class="md-nav__icon md-icon"></span>
          Predictive Inference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/serverless/serverless/" class="md-nav__link">
        Serverless installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/kubernetes_deployment/" class="md-nav__link">
        Kubernetes deployment installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/modelmesh/" class="md-nav__link">
        ModelMesh installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/serverless/kourier_networking/" class="md-nav__link">
        Kourier Networking Layer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_2" type="checkbox" id="__nav_3_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1_2">
          Generative Inference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Generative Inference" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          Generative Inference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/kubernetes_deployment/" class="md-nav__link">
        Kubernetes deployment installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/ai-gateway_integration/" class="md-nav__link">
        AI Gateway Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/serverless/servicemesh/" class="md-nav__link">
        Istio Service Mesh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/gatewayapi_migration/" class="md-nav__link">
        Gateway API migration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Concepts" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1_1" type="checkbox" id="__nav_4_1_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1_1">
          Control Plane
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Control Plane" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_1_1">
          <span class="md-nav__icon md-icon"></span>
          Control Plane
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control_plane/" class="md-nav__link">
        Model Serving Control Plane
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1_2" type="checkbox" id="__nav_4_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1_2">
          Data Plane
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data Plane" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_1_2">
          <span class="md-nav__icon md-icon"></span>
          Data Plane
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_plane/data_plane/" class="md-nav__link">
        Model Serving Data Plane
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_plane/v1_protocol/" class="md-nav__link">
        V1 Inference Protocol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_plane/v2_protocol/" class="md-nav__link">
        Open Inference Protocol (V2 Inference Protocol)
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1_2_4" type="checkbox" id="__nav_4_1_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1_2_4">
          Open Inference Protocol Extensions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Open Inference Protocol Extensions" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_1_2_4">
          <span class="md-nav__icon md-icon"></span>
          Open Inference Protocol Extensions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data_plane/binary_tensor_data_extension/" class="md-nav__link">
        Binary Tensor Data Extension
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../servingruntimes/" class="md-nav__link">
        Serving Runtimes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Generative Inference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Generative Inference" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Generative Inference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_1" type="checkbox" id="__nav_4_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2_1">
          Serving Runtime
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Serving Runtime" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_2_1">
          <span class="md-nav__icon md-icon"></span>
          Serving Runtime
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../llm/huggingface/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../llm/huggingface/text_generation/" class="md-nav__link">
        Text Generation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../llm/huggingface/text2text_generation/" class="md-nav__link">
        Text2Text Generation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../llm/huggingface/sdk_integration/" class="md-nav__link">
        OpenAI SDK Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../llm/huggingface/multi-node/" class="md-nav__link">
        Multi Node Inference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/modelcache/localmodel/" class="md-nav__link">
        Model Cache
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoscaling/keda/autoscaling_llm/" class="md-nav__link">
        LLM Autoscaler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../llm/huggingface/kv_cache_offloading/" class="md-nav__link">
        KV Cache Offloading
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/ai-gateway_integration/" class="md-nav__link">
        AI Gateway Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Predictive Inference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Predictive Inference" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Predictive Inference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1" type="checkbox" id="__nav_4_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_1">
          Model Serving Runtimes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model Serving Runtimes" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_1">
          <span class="md-nav__icon md-icon"></span>
          Model Serving Runtimes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_1" type="checkbox" id="__nav_4_3_1_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_1_1">
          Supported Model Frameworks/Formats
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supported Model Frameworks/Formats" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_1_1">
          <span class="md-nav__icon md-icon"></span>
          Supported Model Frameworks/Formats
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../serving_runtime/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/" class="md-nav__link">
        Tensorflow
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PyTorch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PyTorch
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-model-storage-with-a-model-archive-file-and-config" class="md-nav__link">
    Create Model Storage with a Model Archive File and Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-v1-rest-protocol" class="md-nav__link">
    Deploy PyTorch Model with V1 REST Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch Model with V1 REST Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-torchserve-inferenceservice" class="md-nav__link">
    Create the TorchServe InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-inference" class="md-nav__link">
    Model Inference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-explanation" class="md-nav__link">
    Model Explanation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-v1-grpc-protocol" class="md-nav__link">
    Deploy PyTorch Model with V1 gRPC Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch Model with V1 gRPC Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-inferenceservice" class="md-nav__link">
    Create the InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-inference-with-torchserve-grpc-protocol" class="md-nav__link">
    Run Inference with TorchServe gRPC protocol
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-open-inference-rest-protocol" class="md-nav__link">
    Deploy PyTorch model with Open Inference REST Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch model with Open Inference REST Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-inferenceservice_1" class="md-nav__link">
    Create the InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-inference_1" class="md-nav__link">
    Model Inference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-explanation_1" class="md-nav__link">
    Model Explanation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-open-inference-grpc-protocol" class="md-nav__link">
    Deploy PyTorch Model with Open Inference gRPC Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch Model with Open Inference gRPC Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-inferenceservice_2" class="md-nav__link">
    Create the InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-grpc-inference" class="md-nav__link">
    Run gRPC Inference
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autoscaling" class="md-nav__link">
    Autoscaling
  </a>
  
    <nav class="md-nav" aria-label="Autoscaling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#knative-autoscaler" class="md-nav__link">
    Knative Autoscaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-inferenceservice-with-concurrency-target" class="md-nav__link">
    Create InferenceService with Concurrency Target
  </a>
  
    <nav class="md-nav" aria-label="Create InferenceService with Concurrency Target">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardsoft-autoscaling-limit" class="md-nav__link">
    Hard/Soft Autoscaling Limit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-inference-with-concurrent-requests" class="md-nav__link">
    Run Inference with Concurrent Requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-pod-autoscaling" class="md-nav__link">
    Check Pod Autoscaling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#canary-rollout" class="md-nav__link">
    Canary Rollout
  </a>
  
    <nav class="md-nav" aria-label="Canary Rollout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-inferenceservice-with-canary-model" class="md-nav__link">
    Create InferenceService with Canary Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-traffic-status" class="md-nav__link">
    Check Traffic Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-rollout" class="md-nav__link">
    Traffic Rollout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback-the-model" class="md-nav__link">
    Rollback the Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    Monitoring
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sklearn/v2/" class="md-nav__link">
        Scikit-learn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xgboost/" class="md-nav__link">
        XGBoost
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pmml/" class="md-nav__link">
        PMML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark/" class="md-nav__link">
        Spark MLlib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lightgbm/" class="md-nav__link">
        LightGBM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../paddle/" class="md-nav__link">
        Paddle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mlflow/v2/" class="md-nav__link">
        MLFlow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../onnx/" class="md-nav__link">
        ONNX
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_1_12" type="checkbox" id="__nav_4_3_1_1_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_1_1_12">
          Hugging Face
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hugging Face" data-md-level="5">
        <label class="md-nav__title" for="__nav_4_3_1_1_12">
          <span class="md-nav__icon md-icon"></span>
          Hugging Face
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../huggingface/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../huggingface/token_classification/" class="md-nav__link">
        Token Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../huggingface/text_classification/" class="md-nav__link">
        Text Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../huggingface/fill_mask/" class="md-nav__link">
        Fill Mask
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_2" type="checkbox" id="__nav_4_3_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_1_2">
          Multi-Framework Serving Runtimes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Multi-Framework Serving Runtimes" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          Multi-Framework Serving Runtimes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_2_1" type="checkbox" id="__nav_4_3_1_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_1_2_1">
          Nvidia Triton
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Nvidia Triton" data-md-level="5">
        <label class="md-nav__title" for="__nav_4_3_1_2_1">
          <span class="md-nav__icon md-icon"></span>
          Nvidia Triton
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../triton/torchscript/" class="md-nav__link">
        TorchScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../triton/bert/" class="md-nav__link">
        Tensorflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../triton/huggingface/" class="md-nav__link">
        Hugging Face
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../amd/" class="md-nav__link">
        AMD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../custom/custom_model/" class="md-nav__link">
        How to write a custom predictor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2" type="checkbox" id="__nav_4_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_2">
          Multi Model Serving
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Multi Model Serving" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_2">
          <span class="md-nav__icon md-icon"></span>
          Multi Model Serving
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2_1" type="checkbox" id="__nav_4_3_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_2_1">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mms/multi-model-serving/" class="md-nav__link">
        The Scalability Problem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mms/modelmesh/overview/" class="md-nav__link">
        ModelMesh Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3" type="checkbox" id="__nav_4_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_3">
          Transformers(pre/post processing)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Transformers(pre/post processing)" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_3">
          <span class="md-nav__icon md-icon"></span>
          Transformers(pre/post processing)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../transformer/torchserve_image_transformer/" class="md-nav__link">
        How to write a custom transformer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../transformer/collocation/" class="md-nav__link">
        Collocate transformer and predictor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../transformer/feast/" class="md-nav__link">
        Feast
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_4" type="checkbox" id="__nav_4_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_4">
          Rollout Strategies
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Rollout Strategies" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_4">
          <span class="md-nav__icon md-icon"></span>
          Rollout Strategies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rollout/canary/" class="md-nav__link">
        Canary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rollout/canary-example/" class="md-nav__link">
        Canary Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_5" type="checkbox" id="__nav_4_3_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_5">
          Autoscaling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Autoscaling" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_5">
          <span class="md-nav__icon md-icon"></span>
          Autoscaling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoscaling/autoscaling/" class="md-nav__link">
        Knative Autoscaler(KPA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoscaling/raw_deployment_autoscaling/" class="md-nav__link">
        Kubernetes Autoscaler(HPA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../autoscaling/keda/autoscaling_keda/" class="md-nav__link">
        KEDA Autoscaler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_6" type="checkbox" id="__nav_4_3_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_6">
          Request Batching
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Request Batching" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_6">
          <span class="md-nav__icon md-icon"></span>
          Request Batching
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../batcher/batcher/" class="md-nav__link">
        Inference Batcher
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_7" type="checkbox" id="__nav_4_3_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_7">
          Payload Logging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Payload Logging" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_7">
          <span class="md-nav__icon md-icon"></span>
          Payload Logging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../logger/logger/" class="md-nav__link">
        Inference Logger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_8" type="checkbox" id="__nav_4_3_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_8">
          Kafka
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kafka" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_8">
          <span class="md-nav__icon md-icon"></span>
          Kafka
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kafka/kafka/" class="md-nav__link">
        Inference with Kafka Event Source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_9" type="checkbox" id="__nav_4_3_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_9">
          Inference Observability
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Inference Observability" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_9">
          <span class="md-nav__icon md-icon"></span>
          Inference Observability
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/prometheus_metrics/" class="md-nav__link">
        Prometheus Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../observability/grafana_dashboards/" class="md-nav__link">
        Grafana Dashboards
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_10" type="checkbox" id="__nav_4_3_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_10">
          Model Explainability
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model Explainability" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_10">
          <span class="md-nav__icon md-icon"></span>
          Model Explainability
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../explainer/explainer/" class="md-nav__link">
        Concept
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../explainer/trustyai/" class="md-nav__link">
        TrustyAI Explainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_10_3" type="checkbox" id="__nav_4_3_10_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_10_3">
          Alibi Explainer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Alibi Explainer" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_10_3">
          <span class="md-nav__icon md-icon"></span>
          Alibi Explainer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../explainer/alibi/cifar10/" class="md-nav__link">
        Image Explainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../explainer/alibi/income/" class="md-nav__link">
        Income Explainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../explainer/alibi/moviesentiment/" class="md-nav__link">
        Text Explainer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../explainer/aix/mnist/aix/" class="md-nav__link">
        AIX Explainer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_11" type="checkbox" id="__nav_4_3_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3_11">
          Model Monitoring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model Monitoring" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_11">
          <span class="md-nav__icon md-icon"></span>
          Model Monitoring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detect/alibi_detect/alibi_detect/" class="md-nav__link">
        Alibi Detector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detect/aif/germancredit/" class="md-nav__link">
        AIF Bias Detector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../detect/art/mnist/" class="md-nav__link">
        ART Adversarial Detector
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Inference Graph
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Inference Graph" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Inference Graph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../inference_graph/" class="md-nav__link">
        Concept
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../inference_graph/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../inference_graph/image_pipeline/" class="md-nav__link">
        Image classification inference graph
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Model Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model Storage" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Model Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/storagecontainers/" class="md-nav__link">
        Storage Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../certificate/kserve/" class="md-nav__link">
        Configure CA Certificate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/azure/azure/" class="md-nav__link">
        Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/pvc/pvc/" class="md-nav__link">
        PVC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/s3/s3/" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/oci/" class="md-nav__link">
        OCI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/uri/uri/" class="md-nav__link">
        URI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/gcs/gcs/" class="md-nav__link">
        GCS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../storage/huggingface/hf/" class="md-nav__link">
        Hugging Face
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Node Scheduling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Node Scheduling" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Node Scheduling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../nodescheduling/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../nodescheduling/inferenceservicenodescheduling/" class="md-nav__link">
        InferenceService Node Scheduling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/api/" class="md-nav__link">
        Control Plane API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/swagger-ui/" class="md-nav__link">
        Open Inference Protocol API Spec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sdk_docs/sdk_doc/" class="md-nav__link">
        Python Client SDK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python_runtime_api/docs/" class="md-nav__link">
        Python Runtime Server SDK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../inference_client/doc/" class="md-nav__link">
        Inference Python Client
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Developer Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developer Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer/developer/" class="md-nav__link">
        How to contribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../developer/debug/" class="md-nav__link">
        Debugging guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Blog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Blog" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Blog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Releases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Releases" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Releases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2025-05-27-KServe-0.15-release/" class="md-nav__link">
        KServe 0.15 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2024-12-13-KServe-0.14-release/" class="md-nav__link">
        KServe 0.14 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2024-05-15-KServe-0.13-release/" class="md-nav__link">
        KServe 0.13 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2023-10-08-KServe-0.11-release/" class="md-nav__link">
        KServe 0.11 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2023-02-05-KServe-0.10-release/" class="md-nav__link">
        KServe 0.10 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2022-07-21-KServe-0.9-release/" class="md-nav__link">
        KServe 0.9 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2022-02-18-KServe-0.8-release/" class="md-nav__link">
        KServe 0.8 Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/articles/2021-10-11-KServe-0.7-release/" class="md-nav__link">
        KServe 0.7 Release
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Community
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Community" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Community
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/get_involved/" class="md-nav__link">
        How to Get Involved
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/adopters/" class="md-nav__link">
        Adopters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/presentations/" class="md-nav__link">
        Demos and Presentations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#create-model-storage-with-a-model-archive-file-and-config" class="md-nav__link">
    Create Model Storage with a Model Archive File and Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-v1-rest-protocol" class="md-nav__link">
    Deploy PyTorch Model with V1 REST Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch Model with V1 REST Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-torchserve-inferenceservice" class="md-nav__link">
    Create the TorchServe InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-inference" class="md-nav__link">
    Model Inference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-explanation" class="md-nav__link">
    Model Explanation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-v1-grpc-protocol" class="md-nav__link">
    Deploy PyTorch Model with V1 gRPC Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch Model with V1 gRPC Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-inferenceservice" class="md-nav__link">
    Create the InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-inference-with-torchserve-grpc-protocol" class="md-nav__link">
    Run Inference with TorchServe gRPC protocol
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-open-inference-rest-protocol" class="md-nav__link">
    Deploy PyTorch model with Open Inference REST Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch model with Open Inference REST Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-inferenceservice_1" class="md-nav__link">
    Create the InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-inference_1" class="md-nav__link">
    Model Inference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-explanation_1" class="md-nav__link">
    Model Explanation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-pytorch-model-with-open-inference-grpc-protocol" class="md-nav__link">
    Deploy PyTorch Model with Open Inference gRPC Protocol
  </a>
  
    <nav class="md-nav" aria-label="Deploy PyTorch Model with Open Inference gRPC Protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-inferenceservice_2" class="md-nav__link">
    Create the InferenceService
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-grpc-inference" class="md-nav__link">
    Run gRPC Inference
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autoscaling" class="md-nav__link">
    Autoscaling
  </a>
  
    <nav class="md-nav" aria-label="Autoscaling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#knative-autoscaler" class="md-nav__link">
    Knative Autoscaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-inferenceservice-with-concurrency-target" class="md-nav__link">
    Create InferenceService with Concurrency Target
  </a>
  
    <nav class="md-nav" aria-label="Create InferenceService with Concurrency Target">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardsoft-autoscaling-limit" class="md-nav__link">
    Hard/Soft Autoscaling Limit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-inference-with-concurrent-requests" class="md-nav__link">
    Run Inference with Concurrent Requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-pod-autoscaling" class="md-nav__link">
    Check Pod Autoscaling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#canary-rollout" class="md-nav__link">
    Canary Rollout
  </a>
  
    <nav class="md-nav" aria-label="Canary Rollout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-inferenceservice-with-canary-model" class="md-nav__link">
    Create InferenceService with Canary Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-traffic-status" class="md-nav__link">
    Check Traffic Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-rollout" class="md-nav__link">
    Traffic Rollout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback-the-model" class="md-nav__link">
    Rollback the Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    Monitoring
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/kserve/website/edit/main/docs/modelserving/v1beta1/torchserve/README.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="deploy-a-pytorch-model-with-torchserve-inferenceservice">Deploy a PyTorch Model with TorchServe InferenceService<a class="headerlink" href="#deploy-a-pytorch-model-with-torchserve-inferenceservice" title="Permanent link">&para;</a></h1>
<p>In this example, we deploy a trained PyTorch MNIST model to predict handwritten digits by running an <code>InferenceService</code> with <a href="https://github.com/pytorch/serve">TorchServe runtime</a> which is the default installed serving runtime for PyTorch models. Model interpretability is also an important aspect which helps to understand which of the input features were important for a particular classification. 
<a href="https://captum.ai">Captum</a> is a model interpretability library. In this example, TorchServe <strong>explain</strong> endpoint is implemented with Captum's state-of-the-art algorithm, including integrated gradients to provide users with an easy way to understand which features are contributing to the model output. You can refer to the <a href="https://captum.ai/tutorials/">Captum Tutorial</a> for more examples.</p>
<h2 id="create-model-storage-with-a-model-archive-file-and-config">Create Model Storage with a Model Archive File and Config<a class="headerlink" href="#create-model-storage-with-a-model-archive-file-and-config" title="Permanent link">&para;</a></h2>
<p>The KServe/TorchServe integration expects following model store layout.</p>
<div class="highlight"><pre><span></span><code>├──<span class="w"> </span>config
│<span class="w">   </span>├──<span class="w"> </span>config.properties
├──<span class="w"> </span>model-store
│<span class="w">   </span>├──<span class="w"> </span>densenet_161.mar
│<span class="w">   </span>├──<span class="w"> </span>mnist.mar
</code></pre></div>
<p>TorchServe provides a utility to package all the model artifacts into a single <a href="https://github.com/pytorch/serve/blob/master/model-archiver/README.md">TorchServe Model Archive File (MAR)</a>. After model artifacts are packaged into a MAR file, you then upload to the <strong>model-store</strong> under the model storage path.</p>
<p>You can store your model and dependent files on remote storage or local persistent volume. The MNIST model and dependent files can be obtained from <a href="https://github.com/pytorch/serve/tree/master/examples/image_classifier/mnist">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For remote storage you can choose to start the example using the prebuilt MNIST MAR file stored on KServe example GCS bucket
<code>gs://kfserving-examples/models/torchserve/image_classifier</code>, or generate the MAR file with <code>torch-model-archiver</code> and 
create the model store on remote storage according to the above layout.</p>
<div class="highlight"><pre><span></span><code>torch-model-archiver<span class="w"> </span>--model-name<span class="w"> </span>mnist<span class="w"> </span>--version<span class="w"> </span><span class="m">1</span>.0<span class="w"> </span><span class="se">\</span>
--model-file<span class="w"> </span>model-archiver/model-store/mnist/mnist.py<span class="w"> </span><span class="se">\</span>
--serialized-file<span class="w"> </span>model-archiver/model-store/mnist/mnist_cnn.pt<span class="w"> </span><span class="se">\</span>
--handler<span class="w"> </span>model-archiver/model-store/mnist/mnist_handler.py<span class="w"> </span><span class="se">\</span>
</code></pre></div>
<p>For PVC user please refer to <a href="model-archiver/">model archive file generation</a> for auto generation of MAR files with
the model and dependent files.</p>
</div>
<p>TorchServe uses a <strong>config.properties</strong> file to store configuration. Please see <a href="https://pytorch.org/serve/configuration.html#config-properties-file">here</a> for more details with the properties supported by the configuration file. The following is a sample file for KServe:</p>
<div class="highlight"><pre><span></span><code>inference_address=http://0.0.0.0:8085
management_address=http://0.0.0.0:8085
metrics_address=http://0.0.0.0:8082
grpc_inference_port=7070
grpc_management_port=7071
enable_metrics_api=true
metrics_format=prometheus
number_of_netty_threads=4
job_queue_size=10
enable_envvars_config=true
install_py_dep_per_model=true
model_store=/mnt/models/model-store
model_snapshot={&quot;name&quot;:&quot;startup.cfg&quot;,&quot;modelCount&quot;:1,&quot;models&quot;:{&quot;mnist&quot;:{&quot;1.0&quot;:{&quot;defaultVersion&quot;:true,&quot;marName&quot;:&quot;mnist.mar&quot;,&quot;minWorkers&quot;:1,&quot;maxWorkers&quot;:5,&quot;batchSize&quot;:1,&quot;maxBatchDelay&quot;:10,&quot;responseTimeout&quot;:120}}}}
</code></pre></div>
<p>The KServe/TorchServe integration supports KServe v1/v2 REST protocol. In the <code>config.properties</code>, we need to turn on the flag <code>enable_envvars_config</code> to enable setting the KServe envelop using an environment variable.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The previous <code>service_envelope</code> property has been deprecated and in the <a href="config.properties">config.properties</a> file use the flag <code>enable_envvars_config=true</code> to enable setting the service envelope at runtime.
The requests are converted from KServe inference request format to TorchServe request format and sent to the <code>inference_address</code> configured
via local socket.</p>
</div>
<h2 id="deploy-pytorch-model-with-v1-rest-protocol">Deploy PyTorch Model with V1 REST Protocol<a class="headerlink" href="#deploy-pytorch-model-with-v1-rest-protocol" title="Permanent link">&para;</a></h2>
<h3 id="create-the-torchserve-inferenceservice">Create the TorchServe InferenceService<a class="headerlink" href="#create-the-torchserve-inferenceservice" title="Permanent link">&para;</a></h3>
<p>KServe by default selects the <code>TorchServe</code> runtime when you specify the model format <code>pytorch</code> on new model spec.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">New Schema</label><label for="__tabbed_1_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v1</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v1</span>
</code></pre></div>
</div>
</div>
</div>
<p>For deploying the model on GPU, apply the following <a href="torchserve.yaml">torchserve.yaml</a> to create the <code>InferenceService</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>torchserve.yaml
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">New Schema</label><label for="__tabbed_3_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v1</span>
<span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">          </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4Gi</span>
<span class="w">          </span><span class="nt">nvidia.com/gpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v1</span>
<span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<span class="w">        </span><span class="nt">limits</span><span class="p">:</span>
<span class="w">          </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4Gi</span>
<span class="w">          </span><span class="nt">nvidia.com/gpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>For deploying the model on GPU, apply the <a href="gpu.yaml">gpu.yaml</a> to create the GPU <code>InferenceService</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>gpu.yaml
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code>$<span class="w"> </span>inferenceservice.serving.kserve.io/torchserve<span class="w"> </span>created
</code></pre></div>
</div>
<h3 id="model-inference">Model Inference<a class="headerlink" href="#model-inference" title="Permanent link">&para;</a></h3>
<p>The first step is to <a href="../../../get_started/first_isvc/#4-determine-the-ingress-ip-and-ports">determine the ingress IP and ports</a> and set <code>INGRESS_HOST</code> and <code>INGRESS_PORT</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nv">MODEL_NAME</span><span class="o">=</span>mnist
<span class="nv">SERVICE_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>inferenceservice<span class="w"> </span>torchserve<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.url}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">3</span><span class="k">)</span>
</code></pre></div>
<p>You can use <a href="https://github.com/kserve/kserve/tree/master/docs/samples/v1beta1/torchserve/v1/imgconv">image converter</a> to convert the images to base64 byte array, for other models please refer to <a href="https://github.com/pytorch/serve/tree/master/kubernetes/kserve/kf_request_json">input request</a>.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v1/models/<span class="si">${</span><span class="nv">MODEL_NAME</span><span class="si">}</span>:predict<span class="w"> </span>-d<span class="w"> </span>@./mnist.json
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code>*<span class="w">   </span>Trying<span class="w"> </span><span class="m">52</span>.89.19.61...
*<span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span>a881f5a8c676a41edbccdb0a394a80d6-2069247558.us-west-2.elb.amazonaws.com<span class="w"> </span><span class="o">(</span><span class="m">52</span>.89.19.61<span class="o">)</span><span class="w"> </span>port<span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="o">(</span><span class="c1">#0)</span>
&gt;<span class="w"> </span>PUT<span class="w"> </span>/v1/models/mnist<span class="w"> </span>HTTP/1.1
&gt;<span class="w"> </span>Host:<span class="w"> </span>torchserve.kserve-test.example.com
&gt;<span class="w"> </span>User-Agent:<span class="w"> </span>curl/7.47.0
&gt;<span class="w"> </span>Accept:<span class="w"> </span>*/*
&gt;<span class="w"> </span>Content-Length:<span class="w"> </span><span class="m">167</span>
&gt;<span class="w"> </span>Expect:<span class="w"> </span><span class="m">100</span>-continue
&gt;
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">100</span><span class="w"> </span>Continue
*<span class="w"> </span>We<span class="w"> </span>are<span class="w"> </span>completely<span class="w"> </span>uploaded<span class="w"> </span>and<span class="w"> </span>fine
&lt;<span class="w"> </span>HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
&lt;<span class="w"> </span>cache-control:<span class="w"> </span>no-cache<span class="p">;</span><span class="w"> </span>no-store,<span class="w"> </span>must-revalidate,<span class="w"> </span>private
&lt;<span class="w"> </span>content-length:<span class="w"> </span><span class="m">1</span>
&lt;<span class="w"> </span>date:<span class="w"> </span>Tue,<span class="w"> </span><span class="m">27</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2020</span><span class="w"> </span><span class="m">08</span>:26:19<span class="w"> </span>GMT
&lt;<span class="w"> </span>expires:<span class="w"> </span>Thu,<span class="w"> </span><span class="m">01</span><span class="w"> </span>Jan<span class="w"> </span><span class="m">1970</span><span class="w"> </span><span class="m">00</span>:00:00<span class="w"> </span>UTC
&lt;<span class="w"> </span>pragma:<span class="w"> </span>no-cache
&lt;<span class="w"> </span>x-request-id:<span class="w"> </span>b10cfc9f-cd0f-4cda-9c6c-194c2cdaa517
&lt;<span class="w"> </span>x-envoy-upstream-service-time:<span class="w"> </span><span class="m">6</span>
&lt;<span class="w"> </span>server:<span class="w"> </span>istio-envoy
&lt;
*<span class="w"> </span>Connection<span class="w"> </span><span class="c1">#0 to host a881f5a8c676a41edbccdb0a394a80d6-2069247558.us-west-2.elb.amazonaws.com left intact</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="s2">&quot;2&quot;</span><span class="o">]}</span>
</code></pre></div>
</div>
<h3 id="model-explanation">Model Explanation<a class="headerlink" href="#model-explanation" title="Permanent link">&para;</a></h3>
<p>To get model explanation:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v1/models/mnist:explain<span class="w"> </span>-d<span class="w"> </span>@./mnist.json
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;explanations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[[[[</span><span class="mf">0.0005394675730469475</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0022280013123036043</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003416480100841055</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0051329881112415965</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009973864160829985</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004112560908882716</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009223458030656112</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006676354577291628</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005249806664413386</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0009790519227372953</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0026914653993121195</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0069470097151383995</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00693530415962956</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005973878697847718</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00425042437288857</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0032867281838150977</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004297780258633562</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005643196661192014</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00653025019738562</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0047062916121001185</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0018656628277792628</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0016757477204072532</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0010410417081844845</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0019093520822156726</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004451403461006374</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0008552767257773671</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0027638888169885267</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.006971297052106784</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007316855222185687</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012144494329150574</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011477799383288441</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006846725347670252</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01149386176451476</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0045351987881190655</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007038361889638708</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0035855377023272157</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003031419502053957</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0008611575226775316</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0011085224745969223</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0050840743637658534</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009855491784340777</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007220680811043034</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011374285598070253</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007147725481709019</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0037114580912849457</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00030763245479291384</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0018305492665953394</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010106224395114147</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012932881164284687</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008862892007714321</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0070960526615982435</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0015931137903787505</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0036495747329455906</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0002593849391051298</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.006467265785857396</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00041793201228071674</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004900316089756856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002308395474823997</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007859295399592283</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003916404948969494</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005630750246437249</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0043712538044184375</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006128530599133763</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009446321309831246</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.014173645867037036</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0062988650915794565</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.011473838941118539</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009049151947644047</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007625645864610934</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013721416630061238</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0005580156670410108</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0033404383756480784</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006693278798487951</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003705084551144756</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005100375089529131</span><span class="p">,</span><span class="w"> </span><span class="mf">5.5276874714401074e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007221745280359063</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00573598303916232</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006836169033785967</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0025401608627538936</span><span class="p">,</span><span class="w"> </span><span class="mf">9.303533912921196e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.005914399808621816</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00452643561023696</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003968242261515448</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010422786058967673</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007728358107899074</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01147115923288383</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005683869479056691</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011150670502307374</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008742555292485278</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0032882897575743754</span><span class="p">,</span><span class="w"> </span><span class="mf">0.014841138421861584</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011741228362482451</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0004296862879259221</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0035118140680654854</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006152254410078331</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004925121936901983</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.3611205202801947e-06</span><span class="p">,</span><span class="w"> </span><span class="mf">0.029347073037039074</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02901626308947743</span><span class="p">,</span><span class="w"> </span><span class="mf">0.023379353021343398</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004027157620197582</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01677662249919171</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013497255736128979</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006957482854214602</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0018321766800746145</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008277034396684563</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002733405455464871</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0049579739156640065</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002168016158233997</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020644317321723642</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020912464240293825</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004719691119907336</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007879231202446626</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010594445898145937</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006533067778982801</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002290214592708113</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0036651114968251986</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010753227423379443</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006402706020466243</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.047075193909339695</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.08108259303568185</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.07646875196692542</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1681834845371156</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1610307396135756</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.12010309927453829</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.016148831320070896</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009541525999486027</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04575604594761406</span><span class="p">,</span><span class="w"> </span><span class="mf">0.031470966329886635</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02452149438024385</span><span class="p">,</span><span class="w"> </span><span class="mf">0.016594078577569567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012213591301610382</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002230875840404426</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0036704051254298374</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.006410107592414739</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005578283890924384</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001977103461731095</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008935476507124939</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011305055729953436</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0004946313900665659</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0040266029554395935</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004270765544167256</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.010832150944943138</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01653511868336456</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.011121302103373972</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.42038514526905024</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.22874576003118394</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.16752936178907055</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.17021699697722079</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.09998584936787697</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.09041117495322142</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.10230248444795721</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.15260897522094888</span><span class="p">,</span><span class="w"> </span><span class="mf">0.07770835838531896</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0813761125123066</span><span class="p">,</span><span class="w"> </span><span class="mf">0.027556910053932963</span><span class="p">,</span><span class="w"> </span><span class="mf">0.036305965104261866</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03407793793894619</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01212761779302579</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006695133380685627</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005331392748588556</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.008342680065996267</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00029249776150416367</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002782130291086583</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0027793744856745373</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020525102690845407</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003679269934110004</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009373846012918791</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0031751745946300403</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009042846256743316</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0074141593032070775</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02796812516561052</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.593171583786029</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4830164472795136</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.353860128479443</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.256482708704862</span><span class="p">,</span><span class="w"> </span><span class="mf">0.11515586314578445</span><span class="p">,</span><span class="w"> </span><span class="mf">0.12700563162828346</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0022342450630152204</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.24673707669992118</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.012878340813781437</span><span class="p">,</span><span class="w"> </span><span class="mf">0.16866821780196756</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009739033161051434</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.000827843726513152</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0002137320694585577</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004179480126338929</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008454049232317358</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002767934266266998</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.007070382982749552</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005342127805750565</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.000983984198542354</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007910101170274493</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001266267696096404</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0038575136843053844</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006941130321773131</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.015195182020687892</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.016954974010578504</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.031186444096787943</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.031754626467747966</span><span class="p">,</span><span class="w"> </span><span class="mf">0.038918845112017694</span><span class="p">,</span><span class="w"> </span><span class="mf">0.06248943950328597</span><span class="p">,</span><span class="w"> </span><span class="mf">0.07703301092601872</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0438493628024275</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0482404449771698</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.08718650815999045</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014764704694506415</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.07426336448916614</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.10378029666564882</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008572087846793842</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00017173413848283343</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010058893270893113</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0028410498666004377</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002008290211806285</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011905375389931099</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006071375802943992</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0076080165949142685</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0017127333725310495</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00153128150106188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0033391793764531563</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005373442509691564</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007207746020295443</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007422946703693544</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00699779191449194</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002395328253696969</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.011682618874195954</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.012737004464649057</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05379966383523857</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.07174960461749053</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03027341304050314</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0019411862216381327</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0205575129473766</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04617091711614171</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.017655308106959804</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009297162816368814</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03358572117988279</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1626068444778013</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.015874364762085157</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0013736074085577258</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.014763439328689378</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00631805792697278</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0021769414283267273</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0023061635006792498</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.005569931813561535</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004363218328087518</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00025609463218383973</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009577483244680675</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007257755916229399</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00976284778532342</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006388840235419147</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009017880790555707</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.015308709334434867</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.016743935775597355</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04372596546189275</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03523469356755156</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.017257810114846107</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011960489902313411</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01529079831828911</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.020076559119468443</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.042792547669901516</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0029492027218867116</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.011109560582516062</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.12985858077848939</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2262858575494602</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003391725540087574</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03063368684328981</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01353486587575121</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011140822443932317</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006583451102528798</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005667533945285076</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.004056272267155598</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006394041203204911</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004664893926197093</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010593032387298614</span><span class="p">,</span><span class="w"> </span><span class="mf">0.014750931538689989</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015428721146282149</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012167820222401367</span><span class="p">,</span><span class="w"> </span><span class="mf">0.017604752451202518</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01038886849969188</span><span class="p">,</span><span class="w"> </span><span class="mf">0.020544326931163263</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0004206566917812794</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0037463581359232674</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0024656693040735075</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0026061897697624353</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05186055271869177</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.09158655048397382</span><span class="p">,</span><span class="w"> </span><span class="mf">0.022976389912563913</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.19851635458461808</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.11801281807622972</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.29127727790584423</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.017138655663803876</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04395515676468641</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.019241432506341576</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011342298743447392</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0030625771422964584</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0002867924892991192</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0017908808807543712</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0030114260660488892</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020246448273580006</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003293361220376816</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0036965043883218584</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00013185761728146236</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004355610866966878</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006432601921104354</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004148701459814858</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005974553907915845</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0001399233607281906</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010392944122965082</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015693249298693028</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0459528427528407</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013921539948093455</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06615556518538708</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02921438991320325</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.16345220625101778</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002130491295590408</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.11449749664916867</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.030980255589300607</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04804122537359171</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05144994776295644</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005122827412776085</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006464862173908011</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008624278272940246</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0037316228508156427</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0036947794337026706</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0038173843228389405</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0017091931226819494</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0030871869816778068</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002115642501535999</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006926441921580917</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003023077828426468</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.014451359520861637</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0020793048380231397</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.010948003939342523</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014460716966395166</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01656990336897737</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003052317148320358</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0026729564809943513</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06360067057346147</span><span class="p">,</span><span class="w"> </span><span class="mf">0.07780985635080599</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1436689936630281</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.040817177623437874</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04373367754296477</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.18337299150349698</span><span class="p">,</span><span class="w"> </span><span class="mf">0.025295182977407064</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03874921104331938</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002353901742617205</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011772560401335033</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012480994515707569</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006498422579824301</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00632320984076023</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003407169765754805</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.00944355257990139</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009242583578688485</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005069860444386138</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012666191449103024</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00941789912565746</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004720427012836104</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007597687789204113</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008679266528089945</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00889322771021875</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0008577904940828809</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0022973860384607604</span><span class="p">,</span><span class="w"> </span><span class="mf">0.025328230809207493</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.09908781123080951</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.07836626399832172</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1546141264726177</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2582207272050766</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2297524599578219</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.29561835103416967</span><span class="p">,</span><span class="w"> </span><span class="mf">0.12048787956671528</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06279365699861471</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03832012404275233</span><span class="p">,</span><span class="w"> </span><span class="mf">0.022910264999199934</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005803508497672737</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003858461926053348</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0039451232171312765</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003858476747495933</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0013034515558609956</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.009725756015628606</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0004001101998876524</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006490722835571152</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00800808023631959</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0065880711806331265</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0010264326176194034</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0018914305972878344</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.008822522194658438</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.016650520788128117</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03254382594389507</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.014795713101569494</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05826499837818885</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05165369567511702</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.13384277337594377</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.22572641373340493</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.21584739544668635</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2366836351939208</span><span class="p">,</span><span class="w"> </span><span class="mf">0.14937824076489659</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.08127414932170171</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06720440139736879</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0038552732903526744</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0107597891707803</span><span class="p">,</span><span class="w"> </span><span class="mf">-5.67453590118174e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020161340511396244</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.000783322694907436</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006397207517995289</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005291639205010064</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.008627543242777584</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007700097300051849</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020430960246806138</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012949015733198586</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008428709579953574</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001358177022953576</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00421863939925833</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002657580000868709</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.007339431957237175</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02008439775442315</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0033717631758033114</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05176633249899187</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013790328758662772</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.39102366157050594</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.167341447585844</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04813367828213947</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1367781582239039</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04672809260566293</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03237784669978756</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03218068777925178</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02415063765016493</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.017849899351200002</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002975675228088795</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004819438014786686</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005106898651831245</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0024278620704227456</span><span class="p">,</span><span class="w"> </span><span class="mf">6.784303333368138e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.009644258527009343</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001331907219439711</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014639718434477777</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008481926798958248</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010278031715467508</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003625808326891529</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01121188617599796</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0010634587872994379</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0002603820881968461</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.017985648016990465</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06446652745470374</span><span class="p">,</span><span class="w"> </span><span class="mf">0.07726063173046191</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.24739929795334742</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2701855018480216</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.08888614776216278</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1373325760136816</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02316068912438066</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.042164834956711514</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0009266091344106458</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03141872420427644</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011587728430225652</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0004755143243520787</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005860642609620605</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008979633931394438</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005061734169974005</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003932710387086098</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0015489986106803626</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.010998736164377534</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009378969800902604</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00030577045264713074</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0159329353530375</span><span class="p">,</span><span class="w"> </span><span class="mf">0.014849508018911006</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0026513365659554225</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002923303082126996</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01917908707828847</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02338288107991566</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05706674679291175</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009526265752669624</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.19945255386401284</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.10725519695909647</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.3222906835083537</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03857038318412844</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013279804965996065</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.046626023244262085</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.029299060237210447</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.043269580558906555</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03768510002290657</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02255977771908117</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02632588166863199</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.014417349488098566</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003077271951572957</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0004973277708010661</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0003475839139671271</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014522783025903258</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.012215315671616316</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001693194176229889</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011365785434529038</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0036964574178487792</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.010126738168635003</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.025554378647710443</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006538003839811914</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03181759044467965</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.016424751042854728</span><span class="p">,</span><span class="w"> </span><span class="mf">0.06177539736110035</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.43801735323216856</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.29991040815937386</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2516019795363623</span><span class="p">,</span><span class="w"> </span><span class="mf">0.037789523540809</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.010948746374759491</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0633901687126727</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005976006160777705</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006035133605976937</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04961632526071937</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04142116972831476</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.07558952727782252</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04165176179187153</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02021603856619006</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0027365663096057032</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.011145473712733575</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0003566937349350848</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00546472985268321</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.008009386447317503</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006831207743885825</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0051306149795546365</span><span class="p">,</span><span class="w"> </span><span class="mf">0.016239014770865052</span><span class="p">,</span><span class="w"> </span><span class="mf">0.020925441734273218</span><span class="p">,</span><span class="w"> </span><span class="mf">0.028344800173195076</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004805080609285047</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01880521614501033</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1272329010865855</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.39835936819190537</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.09113694760349819</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04061591094832608</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.12677021961235907</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015567707226741051</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005615051546243333</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06454044862001587</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0195457674752272</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04219686517155871</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.08060569979524296</span><span class="p">,</span><span class="w"> </span><span class="mf">0.027234494361702787</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009152881336047056</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.030865118003992217</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005770311060090559</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002905833371986098</span><span class="p">,</span><span class="w"> </span><span class="mf">5.606663556872091e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003209538083839772</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0018588810743365345</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.007587008852984699</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0021213639853557625</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0007709558092903736</span><span class="p">,</span><span class="w"> </span><span class="mf">0.013883256128746423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.017328713012428214</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03645357525636198</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.04043993335238427</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05730125171252314</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2563293727512057</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.11438826083879326</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02662382809034687</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03525271352483709</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04745678120172762</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0336360484090392</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002916635707204059</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.17950855098650784</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.44161773297052964</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4512180227831197</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.4940283106297913</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1970108671285798</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04344323143078066</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.012005120444897523</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00987576109166055</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0018336757466252476</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0004913959502151706</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0005409724034216215</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005039223900868212</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.00637876531169957</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005189469227685454</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0007676355246000376</span><span class="p">,</span><span class="w"> </span><span class="mf">0.018378100865097655</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015739815031394887</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.035524983116512455</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03781006978038308</span><span class="p">,</span><span class="w"> </span><span class="mf">0.28859052096740495</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0726464110153121</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.026768468497420147</span><span class="p">,</span><span class="w"> </span><span class="mf">0.06278766200288134</span><span class="p">,</span><span class="w"> </span><span class="mf">0.17897045813699355</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.13780371920803108</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.14176458123649577</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1733103177731656</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.3106508869296763</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04788355140275794</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04235327890285105</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.031266625292514394</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.016263819217960652</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.031388328800811355</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.01791363975905968</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.012025067979443894</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008335083985905805</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014386677797296231</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0055376544652972854</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002241522815466253</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.007455256326741617</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0009475207572210404</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020288385162615286</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015399640135796092</span><span class="p">,</span><span class="w"> </span><span class="mf">0.021133843188103074</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.019846405097622234</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003162485751163173</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.14199005055318842</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.044200898667146035</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013395459413208084</span><span class="p">,</span><span class="w"> </span><span class="mf">0.11019680479230103</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.014057216041764874</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.12553853334447865</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05992513534766256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.06467942189539834</span><span class="p">,</span><span class="w"> </span><span class="mf">0.08866056095907732</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.1451321508061849</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.07382491447758655</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.046961739981080476</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0008943713493160624</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03231044103656507</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00036034241706501196</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.011387669277619417</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00014602449257226195</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0021863729003374116</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0018817840156005856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0037909804578166286</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.006511855618626698</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006236866054439829</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001440571166157676</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012795776609942026</span><span class="p">,</span><span class="w"> </span><span class="mf">0.011530545030403624</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03495489377257363</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04792403136095304</span><span class="p">,</span><span class="w"> </span><span class="mf">0.049378583599065225</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03296101702085617</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0005351385876652296</span><span class="p">,</span><span class="w"> </span><span class="mf">0.017744115897640366</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011656622496764954</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0232845869823761</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0561191397060232</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.02854070511118366</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.028614174047247348</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.007763531086362863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01823079560098924</span><span class="p">,</span><span class="w"> </span><span class="mf">0.021961392405283622</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009666681805706179</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009547046884328725</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.008729943263791338</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006408909680578429</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009794327096359952</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0025825219195515304</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007063559189211571</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007867244119267047</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.007936663546039311</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00010710180170593153</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002716512705673228</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0038633557307721487</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014877316616940372</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0004788143065635909</span><span class="p">,</span><span class="w"> </span><span class="mf">0.012508842248031202</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0045381104608414645</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.010650910516128294</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013785341529644855</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.034287643221318206</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.022152707546335495</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.047056481347685974</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.032166744564720455</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.021551611335278546</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002174962503376043</span><span class="p">,</span><span class="w"> </span><span class="mf">0.024344287130424306</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015579272560525105</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010958169741952194</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.010607232913436921</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005548369726118836</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014630046444242706</span><span class="p">,</span><span class="w"> </span><span class="mf">0.013144180105016433</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0031349366359021916</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0010984887428255974</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005426941473328394</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006566511860044785</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0005529184874606495</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00026139355020588705</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002887623443531047</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0013988462990850632</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00203365139495493</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.007276926701775218</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004010419939595932</span><span class="p">,</span><span class="w"> </span><span class="mf">0.017521952161185662</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0006996977433557911</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02083134683611201</span><span class="p">,</span><span class="w"> </span><span class="mf">0.013690533534289498</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005466724359976675</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.008857712321334327</span><span class="p">,</span><span class="w"> </span><span class="mf">0.017408578822635818</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0076439343049154425</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0017861314923539985</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007465865707523924</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008034420825988495</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003976298558337994</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00411970637898539</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004572592545819698</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0029563907011979935</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006382227820088148</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0015153753877889707</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0052626601797995595</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0025664706985019416</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005161751034260073</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0009424280561998445</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0012942360298110595</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011900868416523343</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000984424113178899</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020988269382781564</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005870080062890889</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004950484744457169</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003117643454332697</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002509563565777083</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005831604884101081</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009531085216183116</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010030206821909806</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005858190171099734</span><span class="p">,</span><span class="w"> </span><span class="mf">4.9344529936340524e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004027895832421331</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0025436439920587606</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00531153867563076</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00495942692369508</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009215148318606382</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00010011928317543458</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0060051362999805355</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0008195376963202741</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0041728603512658224</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0017597169567888774</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0010577007775543158</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00046033327178068433</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007674196306044449</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0013386963856532302</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00035183178922260837</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0030610334903526204</span><span class="p">,</span><span class="w"> </span><span class="mf">8.951834979315781e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0023676793550483524</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0002900551076915047</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00207019445286608</span><span class="p">,</span><span class="w"> </span><span class="mf">-7.61697478482574e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0012150086715244216</span><span class="p">,</span><span class="w"> </span><span class="mf">0.009831239281792168</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003479667642621962</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0070584324334114525</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004161851261339585</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0026146296354490665</span><span class="p">,</span><span class="w"> </span><span class="mf">-9.194746959222099e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0013583866966571571</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0016821551239318913</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">]]]]}</span>
</code></pre></div>
</div>
<h2 id="deploy-pytorch-model-with-v1-grpc-protocol">Deploy PyTorch Model with V1 gRPC Protocol<a class="headerlink" href="#deploy-pytorch-model-with-v1-grpc-protocol" title="Permanent link">&para;</a></h2>
<p><em><strong>Note</strong></em>: Since kserve has no grpc client methods for v1, we are using torchserve's grpc v1 client </p>
<h3 id="create-the-inferenceservice">Create the InferenceService<a class="headerlink" href="#create-the-inferenceservice" title="Permanent link">&para;</a></h3>
<p>For deploying the <code>InferenceService</code> with gRPC protocol you need to expose the gRPC port on InferenceService. Here <strong>7070</strong> is torchserve gRPC port.</p>
<p>Apply the following <a href="mnist_grpc.yaml">mnist_grpc.yaml</a> to create the <code>InferenceService</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>mnist_grpc.yaml
</code></pre></div>
<p>Expected Output</p>
<div class="highlight"><pre><span></span><code>inferenceservice.serving.kserve.io/torchserve-grpc<span class="w"> </span>created
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">New Schema</label><label for="__tabbed_6_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">serving.kserve.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InferenceService</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve-grpc&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v1</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7070</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h2c</span>
<span class="w">          </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">serving.kserve.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InferenceService</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve-grpc&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v1</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7070</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h2c</span>
<span class="w">          </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="run-inference-with-torchserve-grpc-protocol">Run Inference with TorchServe gRPC protocol<a class="headerlink" href="#run-inference-with-torchserve-grpc-protocol" title="Permanent link">&para;</a></h3>
<p>Install gRPC python dependencies:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>grpcio<span class="w"> </span>protobuf<span class="w"> </span>grpcio-tools
</code></pre></div>
<p>Download TorchServe's inference and management proto:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>proto/v1

<span class="nv">INFERENCE_PROTO_FILE_PATH</span><span class="o">=</span>https://raw.githubusercontent.com/pytorch/serve/master/frontend/server/src/main/resources/proto/inference.proto
<span class="nv">MANAGEMENT_PROTO_FILE_PATH</span><span class="o">=</span>https://raw.githubusercontent.com/pytorch/serve/master/frontend/server/src/main/resources/proto/management.proto

curl<span class="w"> </span>-s<span class="w"> </span>-L<span class="w"> </span><span class="si">${</span><span class="nv">INFERENCE_PROTO_FILE_PATH</span><span class="si">}</span><span class="w"> </span>&gt;<span class="w"> </span>./proto/v1/inference.proto
curl<span class="w"> </span>-s<span class="w"> </span>-L<span class="w"> </span><span class="si">${</span><span class="nv">MANAGEMENT_PROTO_FILE_PATH</span><span class="si">}</span><span class="w"> </span>&gt;<span class="w"> </span>./proto/v1/management.proto
</code></pre></div>
<p>Generate python gRPC client stub using the proto files:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>grpc_tools.protoc<span class="w"> </span>--proto_path<span class="o">=</span>proto/v1/<span class="w"> </span>--python_out<span class="o">=</span>.<span class="w"> </span>--grpc_python_out<span class="o">=</span>.<span class="w"> </span>proto/v1/inference.proto<span class="w"> </span>proto/v1/management.proto
</code></pre></div>
<p>You can use <a href="https://github.com/kserve/kserve/tree/master/docs/samples/v1beta1/torchserve/v1/imgconv">image converter</a> to convert the images to base64 byte array, for other models please refer to <a href="https://github.com/pytorch/serve/tree/master/kubernetes/kserve/kf_request_json">input request</a>.</p>
<p>Run gRPC Inference using <a href="torchserve_grpc_client.py"><code>torchserve_grpc_client.py</code></a> with <a href="mnist.json"><code>mnist.json</code></a> as an example prediction input.</p>
<div class="highlight"><pre><span></span><code><span class="nv">MODEL_NAME</span><span class="o">=</span>mnist
<span class="nv">INPUT_PATH</span><span class="o">=</span>mnist.json
<span class="nv">SERVICE_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>inferenceservice<span class="w"> </span>torchserve-grpc<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.url}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">3</span><span class="k">)</span>

python<span class="w"> </span>torchserve_grpc_client.py<span class="w"> </span>--api_name<span class="w"> </span>infer<span class="w"> </span>--model<span class="w"> </span><span class="nv">$MODEL_NAME</span><span class="w"> </span>--input_path<span class="w"> </span><span class="nv">$INPUT_PATH</span><span class="w"> </span>--hostname<span class="w"> </span><span class="nv">$SERVICE_HOSTNAME</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
</div>
<div class="highlight"><pre><span></span><code><span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">    </span><span class="m">2</span>
<span class="w">  </span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div>
<h2 id="deploy-pytorch-model-with-open-inference-rest-protocol">Deploy PyTorch model with Open Inference REST Protocol<a class="headerlink" href="#deploy-pytorch-model-with-open-inference-rest-protocol" title="Permanent link">&para;</a></h2>
<h3 id="create-the-inferenceservice_1">Create the InferenceService<a class="headerlink" href="#create-the-inferenceservice_1" title="Permanent link">&para;</a></h3>
<p>KServe by default selects the <code>TorchServe</code> runtime when you specify the model format <code>pytorch</code> on new model spec and enables the KServe v1 inference protocol.
To enable v2 open inference protocol, specify the <code>protocolVersion</code> field with the value <code>v2</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">New Schema</label><label for="__tabbed_7_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve-mnist-v2&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">       </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">         </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">    </span><span class="nt">protocolVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
<span class="w">    </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v2</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve-mnist-v2&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">protocolVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v2</span>
</code></pre></div>
</div>
</div>
</div>
<p>For deploying the model on CPU, apply the <a href="mnist_v2.yaml">mnist_v2.yaml</a> to create the <code>InferenceService</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>mnist_v2.yaml
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code>$<span class="w"> </span>inferenceservice.serving.kserve.io/torchserve-mnist-v2<span class="w"> </span>created
</code></pre></div>
</div>
<h3 id="model-inference_1">Model Inference<a class="headerlink" href="#model-inference_1" title="Permanent link">&para;</a></h3>
<p>The first step is to <a href="../../../get_started/first_isvc/#4-determine-the-ingress-ip-and-ports">determine the ingress IP and ports</a> and set <code>INGRESS_HOST</code> and <code>INGRESS_PORT</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nv">MODEL_NAME</span><span class="o">=</span>mnist
<span class="nv">SERVICE_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>inferenceservice<span class="w"> </span>torchserve-mnist-v2<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.url}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">3</span><span class="k">)</span>
</code></pre></div>
<p>You can send both <strong>byte array</strong> and <strong>tensor</strong> with v2 protocol, for byte array use <a href="https://github.com/kserve/kserve/tree/master/docs/samples/v1beta1/torchserve/v2/bytes_conv">image converter</a> to convert the image to byte array input. Here we use the <a href="mnist_v2_bytes.json">mnist_v2_bytes.json</a> file to run an example inference.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v2/models/<span class="si">${</span><span class="nv">MODEL_NAME</span><span class="si">}</span>/infer<span class="w"> </span>-d<span class="w"> </span>@./mnist_v2_bytes.json
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d3b15cad-50a2-4eaf-80ce-8b0a428bd298&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mnist&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;outputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;predict&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="nt">&quot;datatype&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INT64&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]}]}</span>
</code></pre></div>
</div>
<p>For tensor input use the <a href="https://github.com/kserve/kserve/tree/master/docs/samples/v1beta1/torchserve/v2/tensor_conv">tensor image converter</a> to convert the image to
tensor input and here we use the <a href="mnist_v2.json">mnist_v2.json</a> file to run an example inference.</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v2/models/<span class="si">${</span><span class="nv">MODEL_NAME</span><span class="si">}</span>/infer<span class="w"> </span>-d<span class="w"> </span>@./mnist_v2.json
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2266ec1e-f600-40af-97b5-7429b8195a80&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mnist&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;outputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;predict&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="nt">&quot;datatype&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INT64&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]}]}</span>
</code></pre></div>
</div>
<h3 id="model-explanation_1">Model Explanation<a class="headerlink" href="#model-explanation_1" title="Permanent link">&para;</a></h3>
<p>To get the model explanation with v2 explain endpoint:</p>
<div class="highlight"><pre><span></span><code><span class="nv">MODEL_NAME</span><span class="o">=</span>mnist
curl<span class="w"> </span>-v<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v2/models/mnist/explain<span class="w"> </span>-d<span class="w"> </span>@./mnist_v2.json
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d3b15cad-50a2-4eaf-80ce-8b0a428bd298&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mnist&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;outputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;explain&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;datatype&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FP64&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0040547528781588035</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00022612877200043775</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0001273413606783097</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005648369508785856</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008904784451506994</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0026385365879584796</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0026802458602499875</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002657801604900743</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00024465772895309256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0008218449738666515</span><span class="p">,</span><span class="w"> </span><span class="mf">0.015285917610467934</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007512832227517626</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007094984753782517</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003405668751094489</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0020919252360163056</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00078002938659872</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02299587777864007</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01900432942654754</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001252955497754338</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014666116894338772</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005298396384926053</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007901605067151054</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0039060659788228954</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02317408211645009</span><span class="p">,</span><span class="w"> </span><span class="mf">0.017237917554858186</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010867034286601965</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003001563092717309</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00622421762838887</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006120712336480808</span><span class="p">,</span><span class="w"> </span><span class="mf">0.016736329175541464</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005674718838256385</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004344134814439431</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001232842177319105</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0006867353660007012</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00977289933298656</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.003875493166540815</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0017986937404117591</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0013075440157543057</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0024510980461748236</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0008806773426546923</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00014277890422995419</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.009322313284511257</span><span class="p">,</span><span class="w"> </span><span class="mf">0.020608317953885236</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004351394739722548</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007875565409186222</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0009075897751127677</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00022247237111456804</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007829031603535926</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002666369539125161</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000973336852105775</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000432321003928822</span><span class="p">,</span><span class="w"> </span><span class="mf">0.023657172129172684</span><span class="p">,</span><span class="w"> </span><span class="mf">0.010694844898905204</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002375952975746018</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0020747972047037</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002320101258915877</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0012899205783904548</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007629679655402933</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01044862724376463</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00025032878924736025</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00037708370104137974</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005156369275302328</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0012477582442296628</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-4.442516083381132e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01024804634283815</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0009971135240970147</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0004501048968956462</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0019630535686311007</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006664793297549408</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020157403539278907</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0022144569383238466</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008361583574785395</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00314019428604999</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0028943544591141838</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0031301383432286406</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002113252872926688</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0010321050605717045</span><span class="p">,</span><span class="w"> </span><span class="mf">0.008905753926369048</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002846438277738756</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005305288883499087</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00192711009725932</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0012090042768467344</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0011945156500241256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.005654442715832439</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0020132075345016807</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014689356969061985</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0010743412638183228</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0017047980586912376</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00290660517425009</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007805869640505143</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.541</span><span class="err">*</span><span class="w"> </span><span class="err">Co</span><span class="kc">nne</span><span class="err">c</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">hos</span><span class="kc">t</span><span class="w"> </span><span class="err">localhos</span><span class="kc">t</span><span class="w"> </span><span class="err">le</span><span class="kc">ft</span><span class="w"> </span><span class="err">i</span><span class="kc">nta</span><span class="err">c</span><span class="kc">t</span>
<span class="mf">725422148614e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0014516114512869852</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0002827701966546988</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0014401407633627265</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0023812497776698745</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002146825301700187</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011500529125940918</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0002865015572973405</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0029798151042282686</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0017750295500283872</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0008339859126060243</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00377073933577687</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006093176894575109</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00046905787892409935</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0034053218511795034</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0007450011768391558</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001298767372877851</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.008499247640112315</span><span class="p">,</span><span class="w"> </span><span class="mf">-6.145166131400234e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0011809726042792137</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001838476328106708</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00541110661116898</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.002139234224224006</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0003259163407641124</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.005276118873855287</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.001950984007438105</span><span class="p">,</span><span class="w"> </span><span class="mf">-9.545670742026532e-07</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0007772404228681039</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0001517956264720738</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0064814848131711815</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">8.098064985902114e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00249042660692983</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0020718619200672302</span><span class="p">,</span><span class="w"> </span><span class="mf">-5.341117902942147e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00045564724429915073</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0022750983476959733</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0017164060958460778</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0003221344707738082</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0015560282678744543</span><span class="p">,</span><span class="w"> </span><span class="mf">9.107238495871273e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0008772841497928399</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0006502978626355868</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004128780767525651</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0006030386900152659</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001395995791096219</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0026791526689584344</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0023995008266391488</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0004496096312746451</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003101832450753724</span><span class="p">,</span><span class="w"> </span><span class="mf">0.007494536066960778</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0028641187148287965</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0030525907182629075</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003420222396518567</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0014924018363498125</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0009357388301326025</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0007856228933169799</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0018433973914981437</span><span class="p">,</span><span class="w"> </span><span class="mf">1.6031856831240914e-05</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006999018502034005</span><span class="p">,</span><span class="w"> </span><span class="mf">0.004382250870697946</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0035419313267119365</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0028896748092595375</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.00048734542493666705</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0060873452419295</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000388224990424471</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002533641537585585</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.004352836563597573</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0006079418766875505</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0038101334053377753</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.000828441340357984</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0010901530866342661</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.013135008038845744</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0004734518707654666</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002050423283568135</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.006609451922460863</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0023647861820124366</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0046789204256194</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0018122527412311837</span><span class="p">,</span><span class="w"> </span><span class="mf">0.002137538353955849</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]}]}</span>
</code></pre></div>
</div>
<h2 id="deploy-pytorch-model-with-open-inference-grpc-protocol">Deploy PyTorch Model with Open Inference gRPC Protocol<a class="headerlink" href="#deploy-pytorch-model-with-open-inference-grpc-protocol" title="Permanent link">&para;</a></h2>
<h3 id="create-the-inferenceservice_2">Create the InferenceService<a class="headerlink" href="#create-the-inferenceservice_2" title="Permanent link">&para;</a></h3>
<p>For deploying the <code>InferenceService</code> with <code>Open Inference gRPC Protocol</code> you need to expose the gRPC port on InferenceService. Here <strong>8081</strong> is kserve gRPC port.</p>
<p>Apply the following <a href="mnist_grpc_v2.yaml">mnist_grpc_v2.yaml</a> to create the <code>InferenceService</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>mnist_grpc_v2.yaml
</code></pre></div>
<p>Expected Output</p>
<div class="highlight"><pre><span></span><code><span class="nv">$inferenceservice</span>.serving.kserve.io/torchserve-grpc-v2<span class="w"> </span>created
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">New Schema</label><label for="__tabbed_10_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">serving.kserve.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InferenceService</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve-grpc-v2&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">protocolVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grpc-v2</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v2</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8081</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h2c</span>
<span class="w">          </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">serving.kserve.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">InferenceService</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve-grpc-v2&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">protocolVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grpc-v2</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gs://kfserving-examples/models/torchserve/image_classifier/v2</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8081</span>
<span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h2c</span>
<span class="w">          </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="run-grpc-inference">Run gRPC Inference<a class="headerlink" href="#run-grpc-inference" title="Permanent link">&para;</a></h3>
<p>The first step is to <a href="../../../get_started/first_isvc/#4-determine-the-ingress-ip-and-ports">determine the ingress IP and ports</a> and set <code>INGRESS_HOST</code> and <code>INGRESS_PORT</code>.</p>
<p>Then download Open Inference gRPC proto file:
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>proto/v2

<span class="nv">PROTO_FILE_PATH</span><span class="o">=</span>https://raw.githubusercontent.com/kserve/kserve/master/python/kserve/kserve/protocol/grpc/grpc_predict_v2.proto

curl<span class="w"> </span>-s<span class="w"> </span>-L<span class="w"> </span><span class="si">${</span><span class="nv">PROTO_FILE_PATH</span><span class="si">}</span><span class="w"> </span>&gt;<span class="w"> </span>./proto/v2/grpc_predict_v2.proto
</code></pre></div></p>
<p>Run the inference test with grpcurl:
<div class="highlight"><pre><span></span><code><span class="nv">INPUT_PATH</span><span class="o">=</span>./mnist_v2_grpc_tensor.json
<span class="nv">PROTO_FILE</span><span class="o">=</span>proto/v2/grpc_predict_v2.proto
<span class="nv">SERVICE_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>inferenceservice<span class="w"> </span>torchserve-grpc-v2<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.url}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">3</span><span class="k">)</span>
grpcurl<span class="w"> </span>-v<span class="w"> </span>-plaintext<span class="w"> </span>-proto<span class="w"> </span><span class="si">${</span><span class="nv">PROTO_FILE</span><span class="si">}</span><span class="w"> </span>-authority<span class="w"> </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="w"> </span>-d<span class="w"> </span>@<span class="w"> </span><span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span><span class="w"> </span>inference.GRPCInferenceService.ModelInfer<span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$INPUT_PATH</span><span class="s2">&quot;</span><span class="k">)</span>
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
</div>
<div class="highlight"><pre><span></span><code>Resolved<span class="w"> </span>method<span class="w"> </span>descriptor:
//<span class="w"> </span>The<span class="w"> </span>ModelInfer<span class="w"> </span>API<span class="w"> </span>performs<span class="w"> </span>inference<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>model.<span class="w"> </span>Errors<span class="w"> </span>are
//<span class="w"> </span>indicated<span class="w"> </span>by<span class="w"> </span>the<span class="w"> </span>google.rpc.Status<span class="w"> </span>returned<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>request.<span class="w"> </span>The<span class="w"> </span>OK<span class="w"> </span>code
//<span class="w"> </span>indicates<span class="w"> </span>success<span class="w"> </span>and<span class="w"> </span>other<span class="w"> </span>codes<span class="w"> </span>indicate<span class="w"> </span>failure.
rpc<span class="w"> </span>ModelInfer<span class="w"> </span><span class="o">(</span><span class="w"> </span>.inference.ModelInferRequest<span class="w"> </span><span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span><span class="w"> </span>.inference.ModelInferResponse<span class="w"> </span><span class="o">)</span><span class="p">;</span>

Request<span class="w"> </span>metadata<span class="w"> </span>to<span class="w"> </span>send:
<span class="o">(</span>empty<span class="o">)</span>

Response<span class="w"> </span>headers<span class="w"> </span>received:
content-type:<span class="w"> </span>application/grpc
date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">11</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">13</span>:36:30<span class="w"> </span>GMT
grpc-accept-encoding:<span class="w"> </span>identity,<span class="w"> </span>deflate,<span class="w"> </span>gzip
server:<span class="w"> </span>istio-envoy
x-envoy-upstream-service-time:<span class="w"> </span><span class="m">581</span>

Response<span class="w"> </span>contents:
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;modelName&quot;</span>:<span class="w"> </span><span class="s2">&quot;mnist&quot;</span>,
<span class="w">  </span><span class="s2">&quot;id&quot;</span>:<span class="w"> </span><span class="s2">&quot;d3b15cad-50a2-4eaf-80ce-8b0a428bd298&quot;</span>,
<span class="w">  </span><span class="s2">&quot;outputs&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">    </span><span class="o">{</span>
<span class="w">      </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;input-0&quot;</span>,
<span class="w">      </span><span class="s2">&quot;datatype&quot;</span>:<span class="w"> </span><span class="s2">&quot;INT64&quot;</span>,
<span class="w">      </span><span class="s2">&quot;shape&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;1&quot;</span>
<span class="w">      </span><span class="o">]</span>,
<span class="w">      </span><span class="s2">&quot;contents&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;int64Contents&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">          </span><span class="s2">&quot;1&quot;</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">      </span><span class="o">}</span>
<span class="w">    </span><span class="o">}</span>
<span class="w">  </span><span class="o">]</span>
<span class="o">}</span>

Response<span class="w"> </span>trailers<span class="w"> </span>received:
<span class="o">(</span>empty<span class="o">)</span>
Sent<span class="w"> </span><span class="m">1</span><span class="w"> </span>request<span class="w"> </span>and<span class="w"> </span>received<span class="w"> </span><span class="m">1</span><span class="w"> </span>response
</code></pre></div>
<h2 id="autoscaling">Autoscaling<a class="headerlink" href="#autoscaling" title="Permanent link">&para;</a></h2>
<p>One of the main serverless inference features is to automatically scale the replicas of an <code>InferenceService</code> matching the incoming workload.
KServe by default enables <a href="https://knative.dev/docs/serving/autoscaling/">Knative Pod Autoscaler</a> which watches traffic flow and scales up and down based on the configured metrics.</p>
<h3 id="knative-autoscaler">Knative Autoscaler<a class="headerlink" href="#knative-autoscaler" title="Permanent link">&para;</a></h3>
<p>KServe supports the implementation of <strong>Knative Pod Autoscaler (KPA)</strong> and <strong>Kubernetes’ Horizontal Pod Autoscaler (HPA)</strong>.
The features and limitations of each of these Autoscalers are listed below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to use Kubernetes Horizontal Pod Autoscaler (HPA), you must install <a href="https://knative.dev/docs/install/yaml-install/serving/install-serving-with-yaml/#install-optional-serving-extensions">HPA extension</a></p>
</div>
<p>Knative Pod Autoscaler (KPA)</p>
<ul>
<li>Part of the Knative Serving core and enabled by default once Knative Serving is installed.</li>
<li>Supports scale to zero functionality.</li>
<li>Does not support CPU-based autoscaling.</li>
</ul>
<p>Horizontal Pod Autoscaler (HPA)</p>
<ul>
<li>Not part of the Knative Serving core, and must be enabled after Knative Serving installation.</li>
<li>Does not support scale to zero functionality.</li>
<li>Supports CPU-based autoscaling.</li>
</ul>
<h3 id="create-inferenceservice-with-concurrency-target">Create InferenceService with Concurrency Target<a class="headerlink" href="#create-inferenceservice-with-concurrency-target" title="Permanent link">&para;</a></h3>
<h4 id="hardsoft-autoscaling-limit">Hard/Soft Autoscaling Limit<a class="headerlink" href="#hardsoft-autoscaling-limit" title="Permanent link">&para;</a></h4>
<p>You can configure InferenceService with annotation <code>autoscaling.knative.dev/target</code> for a soft limit. The soft limit is a targeted limit rather than
a strictly enforced bound, particularly if there is a sudden burst of requests, this value can be exceeded.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">New Schema</label><label for="__tabbed_11_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">autoscaling.knative.dev/target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gs://kfserving-examples/models/torchserve/image_classifier/v1&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">autoscaling.knative.dev/target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gs://kfserving-examples/models/torchserve/image_classifier/v1&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>You can also configure InferenceService with field <code>containerConcurrency</code> with a hard limit. The hard limit is an enforced upper bound. 
If concurrency reaches the hard limit, surplus requests will be buffered and must wait until enough capacity is free to execute the requests.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">New Schema</label><label for="__tabbed_12_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">containerConcurrency</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gs://kfserving-examples/models/torchserve/image_classifier/v1&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">containerConcurrency</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gs://kfserving-examples/models/torchserve/image_classifier/v1&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>After specifying the soft or hard limits of the scaling target, you can now deploy the <code>InferenceService</code> with <a href="autoscaling/autoscaling.yaml">autoscaling.yaml</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>autoscaling.yaml
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code>$<span class="w"> </span>inferenceservice.serving.kserve.io/torchserve<span class="w"> </span>created
</code></pre></div>
</div>
<h3 id="run-inference-with-concurrent-requests">Run Inference with Concurrent Requests<a class="headerlink" href="#run-inference-with-concurrent-requests" title="Permanent link">&para;</a></h3>
<p>The first step is to install the <strong>hey</strong> load generator and then send the concurrent requests to the <code>InferenceService</code>.
<div class="highlight"><pre><span></span><code>go<span class="w"> </span>get<span class="w"> </span>-u<span class="w"> </span>github.com/rakyll/hey
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="nv">MODEL_NAME</span><span class="o">=</span>mnist
<span class="nv">SERVICE_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>inferenceservice<span class="w"> </span>torchserve<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.url}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">3</span><span class="k">)</span>
hey<span class="w"> </span>-m<span class="w"> </span>POST<span class="w"> </span>-z<span class="w"> </span>30s<span class="w"> </span>-D<span class="w"> </span>./mnist.json<span class="w"> </span>-host<span class="w"> </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v1/models/<span class="si">${</span><span class="nv">MODEL_NAME</span><span class="si">}</span>:predict
</code></pre></div>
<h3 id="check-pod-autoscaling">Check Pod Autoscaling<a class="headerlink" href="#check-pod-autoscaling" title="Permanent link">&para;</a></h3>
<p><code>hey</code> by default generates 50 requests concurrently, so you can see that the <code>InferenceService</code> scales to 5 pods as the container concurrency target is set to 10.</p>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code>NAME<span class="w">                                                             </span>READY<span class="w">   </span>STATUS<span class="w">        </span>RESTARTS<span class="w">   </span>AGE
torchserve-predictor-default-cj2d8-deployment-69444c9c74-67qwb<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Terminating<span class="w">   </span><span class="m">0</span><span class="w">          </span>103s
torchserve-predictor-default-cj2d8-deployment-69444c9c74-nnxk8<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Terminating<span class="w">   </span><span class="m">0</span><span class="w">          </span>95s
torchserve-predictor-default-cj2d8-deployment-69444c9c74-rq8jq<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Running<span class="w">       </span><span class="m">0</span><span class="w">          </span>50m
torchserve-predictor-default-cj2d8-deployment-69444c9c74-tsrwr<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Running<span class="w">       </span><span class="m">0</span><span class="w">          </span>113s
torchserve-predictor-default-cj2d8-deployment-69444c9c74-vvpjl<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Running<span class="w">       </span><span class="m">0</span><span class="w">          </span>109s
torchserve-predictor-default-cj2d8-deployment-69444c9c74-xvn7t<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Terminating<span class="w">   </span><span class="m">0</span><span class="w">          </span>103s
</code></pre></div>
</div>
<h2 id="canary-rollout">Canary Rollout<a class="headerlink" href="#canary-rollout" title="Permanent link">&para;</a></h2>
<p>Canary rollout is a deployment strategy when you release a new version of model to a small percent of the production traffic.</p>
<h3 id="create-inferenceservice-with-canary-model">Create InferenceService with Canary Model<a class="headerlink" href="#create-inferenceservice-with-canary-model" title="Permanent link">&para;</a></h3>
<p>After the above experiments, now let's see how you can rollout a new model without moving full traffic to the new model by default.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">New Schema</label><label for="__tabbed_14_2">Old Schema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">serving.kserve.io/enable-tag-routing</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">canaryTrafficPercent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">model</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modelFormat</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytorch</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gs://kfserving-examples/models/torchserve/image_classifier/v2&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;serving.kserve.io/v1beta1&quot;</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;InferenceService&quot;</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;torchserve&quot;</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">serving.kserve.io/enable-tag-routing</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">predictor</span><span class="p">:</span>
<span class="w">    </span><span class="nt">canaryTrafficPercent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">pytorch</span><span class="p">:</span>
<span class="w">      </span><span class="nt">storageUri</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gs://kfserving-examples/models/torchserve/image_classifier/v2&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>In this example we change the <code>storageUri</code> to the v2 version with <code>canaryTrafficPercent</code> field and then apply the <a href="canary/canary.yaml">canary.yaml</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>canary.yaml
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>revisions<span class="w"> </span>-l<span class="w"> </span>serving.kserve.io/inferenceservice<span class="o">=</span>torchserve
NAME<span class="w">                                 </span>CONFIG<span class="w"> </span>NAME<span class="w">                    </span>K8S<span class="w"> </span>SERVICE<span class="w"> </span>NAME<span class="w">   </span>GENERATION<span class="w">   </span>READY<span class="w">   </span>REASON<span class="w">   </span>ACTUAL<span class="w"> </span>REPLICAS<span class="w">   </span>DESIRED<span class="w"> </span>REPLICAS
torchserve-predictor-default-00001<span class="w">   </span>torchserve-predictor-default<span class="w">                      </span><span class="m">1</span><span class="w">            </span>True<span class="w">             </span><span class="m">1</span><span class="w">                 </span><span class="m">1</span>
torchserve-predictor-default-00002<span class="w">   </span>torchserve-predictor-default<span class="w">                      </span><span class="m">2</span><span class="w">            </span>True<span class="w">             </span><span class="m">1</span><span class="w">                 </span><span class="m">1</span>

kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-l<span class="w"> </span>serving.kserve.io/inferenceservice<span class="o">=</span>torchserve
NAME<span class="w">                                                             </span>READY<span class="w">   </span>STATUS<span class="w">    </span>RESTARTS<span class="w">   </span>AGE
torchserve-predictor-default-00001-deployment-7d99979c99-p49gk<span class="w">   </span><span class="m">2</span>/2<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>28m
torchserve-predictor-default-00002-deployment-c6fcc65dd-rjknq<span class="w">    </span><span class="m">2</span>/2<span class="w">     </span>Running<span class="w">   </span><span class="m">0</span><span class="w">          </span>3m37s
</code></pre></div>
</div>
<h3 id="check-traffic-status">Check Traffic Status<a class="headerlink" href="#check-traffic-status" title="Permanent link">&para;</a></h3>
<p>After the canary model is rolled out, the traffic should be split between the canary model revision and the "stable" revision which was rolled out with 100% percent traffic, now check the traffic split from the <code>InferenceService</code> traffic status:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>isvc<span class="w"> </span>torchserve<span class="w"> </span>-ojsonpath<span class="o">=</span><span class="s1">&#39;{.status.components}&#39;</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;predictor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://torchserve-predictor-default.default.svc.cluster.local&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;latestCreatedRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latestReadyRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latestRolledoutRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;traffic&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;latestRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;revisionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://latest-torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;latestRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;revisionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00001&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prev&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://prev-torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="traffic-rollout">Traffic Rollout<a class="headerlink" href="#traffic-rollout" title="Permanent link">&para;</a></h3>
<p>Run the following curl requests a few times to the <code>InferenceService</code>, you can see that requests are sent to the two revisions with 20/80 splits.</p>
<div class="highlight"><pre><span></span><code><span class="nv">MODEL_NAME</span><span class="o">=</span>mnist
<span class="nv">SERVICE_HOSTNAME</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>inferenceservice<span class="w"> </span>torchserve<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.url}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">3</span><span class="k">)</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..10<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: </span><span class="si">${</span><span class="nv">SERVICE_HOSTNAME</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v1/models/<span class="si">${</span><span class="nv">MODEL_NAME</span><span class="si">}</span>:predict<span class="w"> </span>-d<span class="w"> </span>@./mnist.json<span class="p">;</span><span class="w"> </span><span class="k">done</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
&lt;html&gt;&lt;title&gt;500:<span class="w"> </span>Internal<span class="w"> </span>Server<span class="w"> </span>Error&lt;/title&gt;&lt;body&gt;500:<span class="w"> </span>Internal<span class="w"> </span>Server<span class="w"> </span>Error&lt;/body&gt;&lt;/html&gt;Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
&lt;html&gt;&lt;title&gt;500:<span class="w"> </span>Internal<span class="w"> </span>Server<span class="w"> </span>Error&lt;/title&gt;&lt;body&gt;500:<span class="w"> </span>Internal<span class="w"> </span>Server<span class="w"> </span>Error&lt;/body&gt;&lt;/html&gt;Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
<span class="o">{</span><span class="s2">&quot;predictions&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">2</span><span class="o">]}</span>Handling<span class="w"> </span>connection<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">8080</span>
</code></pre></div>
</div>
<p>You can notice that when the request hits the canary revision it fails, this is because that the new revision requires the v2 inference input <a href="mnist_v2.json">mnist_v2.json</a> which is a breaking change, in addition the traffic is randomly splitted between the two revisions according to the specified traffic percentage. In this case you should rollout the canary model with <strong>0 canaryTrafficPercent</strong> and use the <strong>latest</strong> tagged url to test the canary model before moving the full traffic to the new model.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>patch<span class="w"> </span>isvc<span class="w"> </span>torchserve<span class="w"> </span>--type<span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/predictor/canaryTrafficPercent&quot;, &quot;value&quot;: 0}]&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-v<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: latest-torchserve-predictor-default.default.example.com&quot;</span><span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>http://<span class="si">${</span><span class="nv">INGRESS_HOST</span><span class="si">}</span>:<span class="si">${</span><span class="nv">INGRESS_PORT</span><span class="si">}</span>/v1/models/<span class="si">${</span><span class="nv">MODEL_NAME</span><span class="si">}</span>:predict<span class="w"> </span>-d<span class="w"> </span>@./mnist.json
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d3b15cad-50a2-4eaf-80ce-8b0a428bd298&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mnist&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;model_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;outputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;predict&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;datatype&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INT64&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]}]}</span>
</code></pre></div>
</div>
<p>After the new model is tested and verified, you can now bump the <strong>canaryTrafficPercent to 100</strong> to fully rollout the traffic to the new revision and now the <code>latestRolledoutRevision</code> becomes <strong>torchserve-predictor-default-00002</strong> and <code>previousRolledoutRevision</code> becomes <strong>torchserve-predictor-default-00001</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>patch<span class="w"> </span>isvc<span class="w"> </span>torchserve<span class="w"> </span>--type<span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/predictor/canaryTrafficPercent&quot;, &quot;value&quot;: 100}]&#39;</span>
</code></pre></div>
<p>Check the traffic status:
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>isvc<span class="w"> </span>torchserve<span class="w"> </span>-ojsonpath<span class="o">=</span><span class="s1">&#39;{.status.components}&#39;</span>
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;predictor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://torchserve-predictor-default.default.svc.cluster.local&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;latestCreatedRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latestReadyRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latestRolledoutRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;previousRolledoutRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;traffic&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;latestRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;revisionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://latest-torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="rollback-the-model">Rollback the Model<a class="headerlink" href="#rollback-the-model" title="Permanent link">&para;</a></h3>
<p>In case the new model version does not work after the traffic is moved to the new revision, you can still patch the <strong>canaryTrafficPercent to 0</strong>  and move the traffic back to the previously rolled model which is <strong>torchserve-predictor-default-00001</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">kubectl</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>patch<span class="w"> </span>isvc<span class="w"> </span>torchserve<span class="w"> </span>--type<span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/predictor/canaryTrafficPercent&quot;, &quot;value&quot;: 0}]&#39;</span>
</code></pre></div>
<p>Check the traffic status:
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>isvc<span class="w"> </span>torchserve<span class="w"> </span>-ojsonpath<span class="o">=</span><span class="s1">&#39;{.status.components}&#39;</span>
</code></pre></div></p>
<div class="admonition success">
<p class="admonition-title">Expected Output</p>
<div class="no-copy highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;predictor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://torchserve-predictor-default.default.svc.cluster.local&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;latestCreatedRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latestReadyRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;latestRolledoutRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;previousRolledoutRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00001&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;traffic&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;latestRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;revisionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00002&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;latest&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://latest-torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;latestRevision&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;revisionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;torchserve-predictor-default-00001&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prev&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://prev-torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://torchserve-predictor-default.default.example.com&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="monitoring">Monitoring<a class="headerlink" href="#monitoring" title="Permanent link">&para;</a></h2>
<p><a href="metrics/">Metrics Exposure and Grafana Dashboard Setup</a></p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../tensorflow/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tensorflow" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Tensorflow
            </div>
          </div>
        </a>
      
      
        
        <a href="../sklearn/v2/" class="md-footer__link md-footer__link--next" aria-label="Next: Scikit-learn" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Scikit-learn
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2021 The KServe Authors
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/kserve" target="_blank" rel="noopener" title="KServe Community on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    <a href="https://github.com/kserve/community/blob/main/README.md#questions-and-issues" target="_blank" rel="noopener" title="Join Slack" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tracking", "navigation.tabs.sticky", "navigation.top"], "search": "../../../assets/javascripts/workers/search.cefbb252.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a5f8ea78.min.js"></script>
      
    
  </body>
</html>